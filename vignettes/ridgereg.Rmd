---
title: "ridgereg"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ridgereg}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(BonusLab)
library(caret)
library(mlbench)
library(leaps)
library(Metrics)
library(MASS)
library(knitr)
```


```{r}
# Load data
data("BostonHousing")
set.seed(3456)

# Split data into test and train
trainIndex <- createDataPartition(BostonHousing$crim, p = .8, 
                                  list = FALSE, 
                                  times = 1)
BostonTrain <- BostonHousing[ trainIndex,]
BostonTest  <- BostonHousing[-trainIndex,]
```





```{r}
# Mehod 1: caret::train - no intercept model :(
set.seed(123)
fit1 <- caret::train(medv~.,
              data = BostonTrain,
              method = "leapForward",
              tuneGrid = data.frame(nvmax=14)
              )
summary(fit1)
```

```{r}
fit1$times

```

```{r}
RMSE_boston <- function(model, train=TRUE){
  if(train==FALSE){
    data <- BostonTest
  } else if (train==TRUE){
    data <- BostonTrain
  }
  actual <- data$medv
  pred <- predict(model, data)
  
  return(sqrt(sum((pred-actual)^2/length(actual))))
}
```


```{r, echo=FALSE}
rmse1<-data.frame(RMSE_boston(fit1, train=TRUE))
colnames(rmse1)<-"RMSE train data"
```


```{r, echo=TRUE}
kable(rmse1)
```




```{r}
# Method 2
fit0 <- lm(medv~1, BostonTrain)
fitF <- lm(medv~., BostonTrain)
fit1 <- stepAIC(fitF, direction="forward", scope=list(lower=fit0, upper=fitF))

```
```{r}
fit1$model
```

